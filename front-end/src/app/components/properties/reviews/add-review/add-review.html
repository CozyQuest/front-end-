<!-- Error Message (Always Visible) -->
@if (errorMessage()) {
  <div class="text-red-600 text-sm mt-6 font-medium animate-fade-in text-center">
    {{ errorMessage() }}
  </div>
}

<!-- Success Message (Always Visible) -->
@if (successMessage()) {
  <div class="text-green-600 text-center text-sm mt-6 font-medium animate-fade-in">
    {{ successMessage() }}
  </div>
}

<!-- Review Form Section -->
<div
  *ngIf="isFormVisible"
  class="max-w-xl w-full mx-auto bg-white rounded-3xl shadow-2xl p-8 space-y-8 animate-fadeInUp border border-gray-100"
>
  <!-- Title -->
  <div class="text-center space-y-1">
    <h2 class="text-3xl font-bold text-neutral-800 tracking-tight">How was your stay?</h2>
    <p class="text-gray-500 text-sm">Your feedback helps others feel at home</p>
  </div>

  <!-- Rating Stars -->
  <div class="flex justify-center space-x-2">
    @for (i of [1, 2, 3, 4, 5]; track i) {
      <button
        type="button"
        class="focus:outline-none"
        (mouseenter)="hoverRating = i"
        (mouseleave)="hoverRating = 0"
        (click)="setRating(i)"
      >
        <i
          class="mdi mdi-star text-4xl transition-transform duration-300 ease-in-out"
          [ngClass]="{
            'text-yellow-500 scale-110': i <= (hoverRating || selectedRating),
            'text-gray-300': i > (hoverRating || selectedRating)
          }"
        ></i>
      </button>
    }
  </div>

  <!-- Checkbox -->
  <div class="flex items-center justify-center space-x-3">
    <input
      type="checkbox"
      id="writeReview"
      class="h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"
      (change)="onToggleWithReview($event)"
    />
    <label for="writeReview" class="text-sm text-gray-600">Add written review</label>
  </div>

  <!-- Form -->
  <form [formGroup]="form" (ngSubmit)="onSubmit()" class="space-y-4">
    @if (showReview) {
      <textarea
        formControlName="reviewText"
        rows="4"
        placeholder="Write your review..."
        class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
      ></textarea>
    }

    <button
      type="submit"
      class="w-full bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition"
    >
      Submit
    </button>
  </form>
</div>
